{% extends "base.html" %}
{% block title %}Urządzenia — Panel Admina{% endblock %}

{% block content %}
<h2 class="mb-4"><i class="bi bi-hdd-stack me-2"></i>Wszystkie urządzenia</h2>

<p class="text-muted">Lista wszystkich urządzeń, które wysłały przynajmniej jeden odczyt.</p>

<div class="table-responsive">
  <table class="table table-striped table-hover align-middle">
    <thead class="table-light">
      <tr>
        <th>#</th>
        <th>Kurnik / Topic</th>
        <th>Device ID</th>
        <th>Odczytów</th>
        <th>Ostatni odczyt</th>
        <th>Akcje</th>
      </tr>
    </thead>
    <tbody>
      {% for r in rows %}
      <tr>
        <td>{{ loop.index }}</td>
        <td>
          {% if r.kurnik_name %}
            <a href="{{ url_for('kurnik_detail', kurnik_id=r.kurnik_id) }}">{{ r.kurnik_name }}</a>
          {% else %}
            <code>{{ r.kurnik }}</code>
          {% endif %}
        </td>
        <td><span class="badge bg-secondary">{{ r.device_id }}</span></td>
        <td>{{ r.cnt }}</td>
        <td><small class="text-muted">{{ r.last_seen.strftime('%Y-%m-%d %H:%M') if r.last_seen else '—' }}</small></td>
        <td>
          {% if r.kurnik_id %}
            <a class="btn btn-sm btn-outline-primary" href="{{ url_for('device_detail', kurnik_id=r.kurnik_id, device_id=r.device_id) }}">Pokaż</a>
          {% else %}
            <span class="text-muted">—</span>
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

{% endblock %}
